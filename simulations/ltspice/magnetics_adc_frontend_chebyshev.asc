Version 4
SHEET 1 1884 1232
WIRE 48 -384 16 -384
WIRE 528 -384 496 -384
WIRE 864 -384 816 -384
WIRE -1312 -80 -1568 -80
WIRE -1200 -80 -1312 -80
WIRE -1056 -80 -1120 -80
WIRE -720 -80 -1056 -80
WIRE -336 -80 -640 -80
WIRE -48 -80 -256 -80
WIRE 16 -80 -48 -80
WIRE 464 -80 96 -80
WIRE 560 -80 560 -160
WIRE 560 -80 464 -80
WIRE -1856 -48 -2016 -48
WIRE -1056 -48 -1056 -80
WIRE 656 -48 528 -48
WIRE -1312 -32 -1312 -80
WIRE 464 -32 464 -80
WIRE 416 -16 400 -16
WIRE -1856 0 -1856 -48
WIRE -1728 16 -1728 -80
WIRE -1696 16 -1728 16
WIRE 416 32 400 32
WIRE 528 48 528 -48
WIRE 560 48 528 48
WIRE 656 64 656 -48
WIRE 656 64 624 64
WIRE 688 64 656 64
WIRE 848 64 768 64
WIRE 464 80 464 48
WIRE 560 80 464 80
WIRE -1856 96 -1856 80
WIRE -1312 96 -1312 32
WIRE -1248 96 -1312 96
WIRE -1056 96 -1056 16
WIRE -1056 96 -1248 96
WIRE 624 96 592 96
WIRE 560 112 464 112
WIRE -1312 128 -1312 96
WIRE -1056 128 -1056 96
WIRE 656 128 624 128
WIRE 688 128 656 128
WIRE 848 128 848 64
WIRE 848 128 768 128
WIRE 464 144 464 112
WIRE 560 144 544 144
WIRE 848 144 848 128
WIRE 592 160 592 128
WIRE -1696 176 -1728 176
WIRE -1856 192 -1856 176
WIRE 416 208 400 208
WIRE 544 224 544 144
WIRE 656 224 656 128
WIRE 656 224 544 224
WIRE -1728 272 -1728 176
WIRE -1312 272 -1312 192
WIRE -1312 272 -1568 272
WIRE -1184 272 -1312 272
WIRE -1056 272 -1056 192
WIRE -1056 272 -1104 272
WIRE -704 272 -1056 272
WIRE -336 272 -624 272
WIRE -48 272 -256 272
WIRE 16 272 -48 272
WIRE 464 272 464 224
WIRE 464 272 96 272
WIRE 560 272 464 272
WIRE -1856 304 -1856 272
WIRE -1856 304 -2000 304
WIRE 560 352 560 272
WIRE -752 496 -816 496
WIRE -752 544 -752 496
WIRE -752 688 -752 624
WIRE -624 688 -752 688
WIRE -752 736 -752 688
WIRE -752 880 -752 816
FLAG -1728 -80 AIN+
FLAG -1728 272 AIN-
FLAG -48 336 0
FLAG -48 -16 0
FLAG 80 -128 0
FLAG 80 320 0
FLAG 32 -128 V_IN_SW
FLAG 32 320 V_IN_SW
FLAG 128 -384 0
FLAG 16 -384 V_IN_SW
FLAG 608 -384 0
FLAG 496 -384 V_SHA_SW
FLAG 400 -16 0
FLAG 400 32 V_SHA_SW
FLAG 624 -160 0
FLAG 624 352 0
FLAG -2016 -48 AIN+
FLAG -2000 304 AIN-
FLAG -752 880 0
FLAG -624 688 V_bias
FLAG 944 -384 0
FLAG 816 -384 VREF
FLAG -752 496 VREF
FLAG 624 96 0
FLAG 848 144 0
FLAG 400 208 V_SHA_SW
FLAG 416 160 0
FLAG 592 160 VREF
FLAG 592 32 VREF
FLAG -1568 96 V_bias
FLAG -1248 96 V_bias
DATAFLAG 816 64 ""
SYMBOL sw 112 272 M270
SYMATTR InstName S1
SYMATTR Value SW1
SYMBOL sw 112 -80 R90
SYMATTR InstName S2
SYMATTR Value SW1
SYMBOL voltage 32 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -117 -178 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 3.3 0 2.14e-9 2.14e-9 10e-9 28.57e-9 1e6)
SYMBOL cap -32 336 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value {C_P}
SYMBOL cap -32 -16 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value {C_P}
SYMBOL voltage 512 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(3.3 0 0 2.14e-9 2.14e-9 10e-9 28.57e-9 1e6)
SYMBOL sw 464 -48 R0
SYMATTR InstName S3
SYMATTR Value SW1
SYMBOL cap 624 -176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 44 18 VTop 2
SYMATTR InstName C3
SYMATTR Value {C_H}
SYMBOL cap 624 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {C_H}
SYMBOL voltage -1856 80 R0
WINDOW 123 -22 317 Left 2
WINDOW 39 -17 345 Left 2
WINDOW 3 -20 287 Left 2
SYMATTR Value2 AC 1 0
SYMATTR SpiceLine Rser=0
SYMATTR Value SINE(0 1.5 1e6 0 0 0 1e6)
SYMATTR InstName V3
SYMBOL res -768 528 R0
SYMATTR InstName R6
SYMATTR Value {R_div}
SYMBOL res -768 720 R0
SYMATTR InstName R7
SYMATTR Value {R_div}
SYMBOL OpAmps\\UniversalOpAmp 592 64 R0
SYMATTR InstName U2
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL voltage 848 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL res 784 48 R90
WINDOW 0 60 -4 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100e3
SYMBOL sw 464 128 R0
SYMATTR InstName S4
SYMATTR Value SW1
SYMBOL OpAmps\\UniversalOpAmp 592 128 M180
SYMATTR InstName U1
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 784 112 R90
WINDOW 0 60 1 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100e3
SYMBOL cap -1072 128 R0
SYMATTR InstName C8
SYMATTR Value {2*C_filter}
SYMBOL ind -1104 -96 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 -47 1 VTop 2
SYMATTR InstName L1
SYMATTR Value {{L_filter} + 0.05*{L_filter}}
SYMBOL ind -1088 256 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 70 25 VTop 2
SYMATTR InstName L2
SYMATTR Value {{L_filter}-0.05*{L_filter}}
SYMBOL res -240 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 0.01
SYMBOL res -240 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 0.01
SYMBOL res -624 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 0.01
SYMBOL res -608 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 0.01
SYMBOL cap -1328 -32 R0
SYMATTR InstName C5
SYMATTR Value {2*C_filter}
SYMBOL ZZZ\\TRANSFORMer\\transformer_trace50 -1552 272 R180
SYMATTR InstName U3
SYMBOL cap -1328 128 R0
SYMATTR InstName C6
SYMATTR Value {2*C_filter}
SYMBOL cap -1072 -48 R0
SYMATTR InstName C7
SYMATTR Value {2*C_filter}
SYMBOL res -1872 -16 R0
WINDOW 0 -89 56 Left 2
WINDOW 3 -125 89 Left 2
SYMATTR InstName R4
SYMATTR Value {{R_diff}/2}
SYMBOL res -1872 176 R0
WINDOW 0 -89 56 Left 2
WINDOW 3 -125 89 Left 2
SYMATTR InstName R3
SYMATTR Value {{R_diff}/2}
TEXT -1184 -184 Left 2 !.param C_P=5e-9 C_H=5e-9 t_rf=2.14e-9 tch=10e-9 C_block=100e-9 R_diff=100 R_tl=1 R_div=4.7e3 L_filter=514nH C_filter=430pF
TEXT -368 616 Left 2 !.tran 0 10e-6 0 1e-10
TEXT -848 -648 Left 2 ;CLK_LOW:\n- SW1, SW2: closed, SW3: open\n- Ch is charged\nCLK LOW->HIGH:\n- SW1, SW2: opened, SW3: closed\n- SHA in HOLD mode\na few moments later\n- SW3 closed\n- Amplifier output == CH voltage
TEXT 1200 -16 Left 2 !.model SW1 SW(Ron=1 Roff=1e9 Vt=1.5 Vh=0)
TEXT 656 392 Left 2 ;Ideal buffering OPAMP \n- SHORT between 2 inputs\n- infinite input impedance\nNote: in order to buffer a differential signals we need 2 buffers
TEXT 688 8 Left 2 ;Input impedance for next stage
TEXT -408 488 Left 2 ;.ac oct 1e3 1e3 15e6
TEXT -272 992 Left 2 ;NOTES ON DIFFERENTIAL VS SINGLE-ENDED FILTERS\nDifferential filter\n- differential impedance Zd(f) (to differential component: Vd = V+ - V-)\n- common mode impedance infinity (to common-mode component (V+ + V-) / 2) \n- So the filter acts purely on the differential mode.\n- Ground variations only affect common-mode voltage, not the filtered differential voltage\nSingle-ended filter\n- Filters signal w.r.t. ground -> single-ended signals take this path back to source.\n- Stray currents can change the filter's behavior and the line voltage
RECTANGLE Normal 1024 592 -112 -448 2
RECTANGLE Normal -896 400 -1376 -144 2
RECTANGLE Normal -400 400 -880 -144 2
