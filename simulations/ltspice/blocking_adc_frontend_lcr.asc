Version 4
SHEET 1 1884 2248
WIRE -16 -432 -48 -432
WIRE 432 -416 400 -416
WIRE 32 -128 -32 -128
WIRE -2320 -80 -2480 -80
WIRE -784 -80 -816 -80
WIRE -640 -80 -704 -80
WIRE -416 -80 -576 -80
WIRE -336 -80 -416 -80
WIRE -48 -80 -256 -80
WIRE 16 -80 -48 -80
WIRE 208 -80 96 -80
WIRE 304 -80 304 -160
WIRE 304 -80 208 -80
WIRE -2320 -48 -2320 -80
WIRE 400 -48 272 -48
WIRE 208 -32 208 -80
WIRE 160 -16 144 -16
WIRE 160 32 144 32
WIRE 272 48 272 -48
WIRE 304 48 272 48
WIRE -2320 64 -2320 32
WIRE -416 64 -416 0
WIRE -368 64 -416 64
WIRE 400 64 400 -48
WIRE 400 64 368 64
WIRE 432 64 400 64
WIRE 592 64 512 64
WIRE 208 80 208 48
WIRE 304 80 208 80
WIRE 368 96 336 96
WIRE 304 112 208 112
WIRE -416 128 -416 64
WIRE 400 128 368 128
WIRE 432 128 400 128
WIRE 592 128 592 64
WIRE 592 128 512 128
WIRE 208 144 208 112
WIRE 304 144 288 144
WIRE 592 144 592 128
WIRE 336 160 336 128
WIRE -2320 176 -2320 144
WIRE 160 208 144 208
WIRE 288 224 288 144
WIRE 400 224 400 128
WIRE 400 224 288 224
WIRE -2320 272 -2320 256
WIRE -2320 272 -2464 272
WIRE -784 272 -816 272
WIRE -640 272 -704 272
WIRE -416 272 -416 208
WIRE -416 272 -576 272
WIRE -336 272 -416 272
WIRE -48 272 -256 272
WIRE 16 272 -48 272
WIRE 208 272 208 224
WIRE 208 272 96 272
WIRE 304 272 208 272
WIRE 304 352 304 272
WIRE -2480 448 -2544 448
WIRE -2480 496 -2480 448
WIRE -2704 528 -2704 480
WIRE -2480 640 -2480 576
WIRE -2352 640 -2480 640
WIRE -2480 688 -2480 640
WIRE 64 768 0 768
WIRE -1232 816 -1264 816
WIRE -1088 816 -1152 816
WIRE -944 816 -1024 816
WIRE -816 816 -864 816
WIRE -672 816 -736 816
WIRE -480 816 -672 816
WIRE -304 816 -480 816
WIRE -16 816 -224 816
WIRE 48 816 -16 816
WIRE 240 816 128 816
WIRE 336 816 336 736
WIRE 336 816 240 816
WIRE -2480 832 -2480 768
WIRE -480 848 -480 816
WIRE 432 848 304 848
WIRE 240 864 240 816
WIRE 192 880 176 880
WIRE 192 928 176 928
WIRE 304 944 304 848
WIRE 336 944 304 944
WIRE 432 960 432 848
WIRE 432 960 400 960
WIRE 464 960 432 960
WIRE 624 960 544 960
WIRE -672 976 -672 816
WIRE 240 976 240 944
WIRE 336 976 240 976
WIRE -480 992 -480 928
WIRE -432 992 -480 992
WIRE 400 992 368 992
WIRE 336 1008 240 1008
WIRE 432 1024 400 1024
WIRE 464 1024 432 1024
WIRE 624 1024 624 960
WIRE 624 1024 544 1024
WIRE 240 1040 240 1008
WIRE 336 1040 320 1040
WIRE 624 1040 624 1024
WIRE -480 1056 -480 992
WIRE 368 1056 368 1024
WIRE 192 1104 176 1104
WIRE 320 1120 320 1040
WIRE 432 1120 432 1024
WIRE 432 1120 320 1120
WIRE -1232 1168 -1264 1168
WIRE -1088 1168 -1152 1168
WIRE -944 1168 -1024 1168
WIRE -800 1168 -864 1168
WIRE -672 1168 -672 1040
WIRE -672 1168 -720 1168
WIRE -480 1168 -480 1136
WIRE -480 1168 -672 1168
WIRE -304 1168 -480 1168
WIRE -16 1168 -224 1168
WIRE 48 1168 -16 1168
WIRE 240 1168 240 1120
WIRE 240 1168 128 1168
WIRE 336 1168 240 1168
WIRE 336 1248 336 1168
WIRE 64 1616 0 1616
WIRE -1232 1664 -1264 1664
WIRE -1088 1664 -1152 1664
WIRE -944 1664 -1024 1664
WIRE -816 1664 -864 1664
WIRE -672 1664 -736 1664
WIRE -480 1664 -672 1664
WIRE -304 1664 -480 1664
WIRE -16 1664 -224 1664
WIRE 48 1664 -16 1664
WIRE 240 1664 128 1664
WIRE 336 1664 336 1584
WIRE 336 1664 240 1664
WIRE -480 1696 -480 1664
WIRE 432 1696 304 1696
WIRE 240 1712 240 1664
WIRE 192 1728 176 1728
WIRE 192 1776 176 1776
WIRE 304 1792 304 1696
WIRE 336 1792 304 1792
WIRE 432 1808 432 1696
WIRE 432 1808 400 1808
WIRE 464 1808 432 1808
WIRE 624 1808 544 1808
WIRE -672 1824 -672 1664
WIRE 240 1824 240 1792
WIRE 336 1824 240 1824
WIRE -480 1840 -480 1776
WIRE -432 1840 -480 1840
WIRE 400 1840 368 1840
WIRE 336 1856 240 1856
WIRE 432 1872 400 1872
WIRE 464 1872 432 1872
WIRE 624 1872 624 1808
WIRE 624 1872 544 1872
WIRE 240 1888 240 1856
WIRE 336 1888 320 1888
WIRE 624 1888 624 1872
WIRE -480 1904 -480 1840
WIRE 368 1904 368 1872
WIRE 192 1952 176 1952
WIRE 320 1968 320 1888
WIRE 432 1968 432 1872
WIRE 432 1968 320 1968
WIRE -1232 2016 -1264 2016
WIRE -1088 2016 -1152 2016
WIRE -944 2016 -1024 2016
WIRE -800 2016 -864 2016
WIRE -672 2016 -672 1888
WIRE -672 2016 -720 2016
WIRE -480 2016 -480 1984
WIRE -480 2016 -672 2016
WIRE -304 2016 -480 2016
WIRE -16 2016 -224 2016
WIRE 48 2016 -16 2016
WIRE 240 2016 240 1968
WIRE 240 2016 128 2016
WIRE 336 2016 240 2016
WIRE 336 2096 336 2016
FLAG -816 -80 AIN+
FLAG -816 272 AIN-
FLAG -48 336 0
FLAG -48 -16 0
FLAG 80 -128 0
FLAG 80 320 0
FLAG -32 -128 V_IN_SW
FLAG 32 320 V_IN_SW
FLAG 64 -432 0
FLAG -48 -432 V_IN_SW
FLAG 512 -416 0
FLAG 400 -416 V_SHA_SW
FLAG 144 -16 0
FLAG 144 32 V_SHA_SW
FLAG 368 -160 0
FLAG 368 352 0
FLAG -2480 -80 AIN+
FLAG -2464 272 AIN-
FLAG -2480 832 0
FLAG -2352 640 V_bias
FLAG -2704 608 0
FLAG -2704 480 VREF
FLAG -2480 448 VREF
FLAG 368 96 0
FLAG 592 144 0
FLAG 144 208 V_SHA_SW
FLAG 160 160 0
FLAG 336 160 VREF
FLAG 336 32 VREF
FLAG -1264 816 AIN+
FLAG -1264 1168 AIN-
FLAG -16 1232 0
FLAG -16 880 0
FLAG 112 768 0
FLAG 112 1216 0
FLAG 0 768 V_IN_SW
FLAG 64 1216 V_IN_SW
FLAG 176 880 0
FLAG 176 928 V_SHA_SW
FLAG 400 736 0
FLAG 400 1248 0
FLAG -432 992 V_bias
FLAG 400 992 0
FLAG 624 1040 0
FLAG 176 1104 V_SHA_SW
FLAG 192 1056 0
FLAG 368 1056 VREF
FLAG 368 928 VREF
FLAG -1264 1664 AIN+
FLAG -1264 2016 AIN-
FLAG -16 2080 0
FLAG -16 1728 0
FLAG 112 1616 0
FLAG 112 2064 0
FLAG 0 1616 V_IN_SW
FLAG 64 2064 V_IN_SW
FLAG 176 1728 0
FLAG 176 1776 V_SHA_SW
FLAG 400 1584 0
FLAG 400 2096 0
FLAG -432 1840 V_bias
FLAG 400 1840 0
FLAG 624 1888 0
FLAG 176 1952 V_SHA_SW
FLAG 192 1904 0
FLAG 368 1904 VREF
FLAG 368 1776 VREF
FLAG -368 64 V_bias
DATAFLAG 560 64 ""
DATAFLAG 592 960 ""
DATAFLAG 592 1808 ""
SYMBOL sw 112 272 M270
SYMATTR InstName S1
SYMATTR Value SW1
SYMBOL sw 112 -80 R90
SYMATTR InstName S2
SYMATTR Value SW1
SYMBOL voltage -32 -432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -117 -178 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 3.3 0 2.14e-9 2.14e-9 10e-9 28.57e-9 1e6)
SYMBOL cap -32 336 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value {C_P}
SYMBOL cap -32 -16 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value {C_P}
SYMBOL voltage 416 -416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(3.3 0 0 2.14e-9 2.14e-9 10e-9 28.57e-9 1e6)
SYMBOL sw 208 -48 R0
SYMATTR InstName S3
SYMATTR Value SW1
SYMBOL cap 368 -176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 44 18 VTop 2
SYMATTR InstName C3
SYMATTR Value {C_H}
SYMBOL cap 368 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {C_H}
SYMBOL voltage -2320 48 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR Value2 AC 1 0
SYMATTR SpiceLine Rser=0
SYMATTR InstName V3
SYMATTR Value SINE(0 1.5 1e6 0 0 0 1e6)
SYMBOL res -688 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R_tl}
SYMBOL res -688 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R_tl}
SYMBOL res -2496 480 R0
SYMATTR InstName R6
SYMATTR Value {R_div}
SYMBOL res -2496 672 R0
SYMATTR InstName R7
SYMATTR Value {R_div}
SYMBOL OpAmps\\UniversalOpAmp 336 64 R0
SYMATTR InstName U2
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL voltage -2704 512 R0
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL res 528 48 R90
WINDOW 0 60 -4 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100e3
SYMBOL sw 208 128 R0
SYMATTR InstName S4
SYMATTR Value SW1
SYMBOL OpAmps\\UniversalOpAmp 336 128 M180
SYMATTR InstName U1
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 528 112 R90
WINDOW 0 60 1 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100e3
SYMBOL cap -576 -96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value {C_block}
SYMBOL cap -576 256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value {C_block}
SYMBOL res -240 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 0.01
SYMBOL res -240 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 0.01
SYMBOL res -2336 -64 R0
WINDOW 0 -89 56 Left 2
WINDOW 3 -125 89 Left 2
SYMATTR InstName R14
SYMATTR Value {{R_diff}/2}
SYMBOL res -2336 160 R0
WINDOW 0 -89 56 Left 2
WINDOW 3 -125 89 Left 2
SYMATTR InstName R3
SYMATTR Value {{R_diff}/2}
SYMBOL sw 144 1168 M270
SYMATTR InstName S5
SYMATTR Value SW1
SYMBOL sw 144 816 R90
SYMATTR InstName S6
SYMATTR Value SW1
SYMBOL cap 0 1232 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value {C_P}
SYMBOL cap 0 880 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value {C_P}
SYMBOL sw 240 848 R0
SYMATTR InstName S7
SYMATTR Value SW1
SYMBOL cap 400 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 44 18 VTop 2
SYMATTR InstName C10
SYMATTR Value {C_H}
SYMBOL cap 400 1232 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value {C_H}
SYMBOL res -1136 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value {R_tl}
SYMBOL res -1136 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {R_tl}
SYMBOL res -496 832 R0
SYMATTR InstName R17
SYMATTR Value {R_diff/2}
SYMBOL res -496 1040 R0
SYMATTR InstName R18
SYMATTR Value {R_diff/2}
SYMBOL OpAmps\\UniversalOpAmp 368 960 R0
SYMATTR InstName U3
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 560 944 R90
WINDOW 0 60 -4 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100e3
SYMBOL sw 240 1024 R0
SYMATTR InstName S8
SYMATTR Value SW1
SYMBOL OpAmps\\UniversalOpAmp 368 1024 M180
SYMATTR InstName U4
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 560 1008 R90
WINDOW 0 60 1 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100e3
SYMBOL cap -688 976 R0
SYMATTR InstName C12
SYMATTR Value {C_filter}
SYMBOL res -848 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 5
SYMBOL res -848 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 5
SYMBOL ind -720 800 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 -47 1 VTop 2
SYMATTR InstName L3
SYMATTR Value {{L_filter} + 0.05*{L_filter}}
SYMBOL ind -704 1152 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 70 25 VTop 2
SYMATTR InstName L4
SYMATTR Value {{L_filter}-0.05*{L_filter}}
SYMBOL cap -1024 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value {C_block}
SYMBOL cap -1024 1152 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C14
SYMATTR Value {C_block}
SYMBOL res -208 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 0.01
SYMBOL res -208 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 0.01
SYMBOL sw 144 2016 M270
SYMATTR InstName S9
SYMATTR Value SW1
SYMBOL sw 144 1664 R90
SYMATTR InstName S10
SYMATTR Value SW1
SYMBOL cap 0 2080 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C15
SYMATTR Value {C_P}
SYMBOL cap 0 1728 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C16
SYMATTR Value {C_P}
SYMBOL sw 240 1696 R0
SYMATTR InstName S11
SYMATTR Value SW1
SYMBOL cap 400 1568 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 44 18 VTop 2
SYMATTR InstName C17
SYMATTR Value {C_H}
SYMBOL cap 400 2080 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C18
SYMATTR Value {C_H}
SYMBOL res -1136 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value {R_tl}
SYMBOL res -1136 2000 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value {R_tl}
SYMBOL res -496 1680 R0
SYMATTR InstName R27
SYMATTR Value {R_diff/2}
SYMBOL res -496 1888 R0
SYMATTR InstName R28
SYMATTR Value {R_diff/2}
SYMBOL OpAmps\\UniversalOpAmp 368 1808 R0
SYMATTR InstName U5
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 560 1792 R90
WINDOW 0 60 -4 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 100e3
SYMBOL sw 240 1872 R0
SYMATTR InstName S12
SYMATTR Value SW1
SYMBOL OpAmps\\UniversalOpAmp 368 1872 M180
SYMATTR InstName U6
SYMATTR Value2 Avol=1000 GBW=2e20 Vos=0
SYMBOL res 560 1856 R90
WINDOW 0 60 1 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 100e3
SYMBOL cap -688 1824 R0
SYMATTR InstName C19
SYMATTR Value {C_filter}
SYMBOL res -848 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 5
SYMBOL res -848 2000 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R32
SYMATTR Value 5
SYMBOL ind -720 1648 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 -47 1 VTop 2
SYMATTR InstName L5
SYMATTR Value {{L_filter} + 0.05*{L_filter}}
SYMBOL ind -704 2000 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 70 25 VTop 2
SYMATTR InstName L6
SYMATTR Value {{L_filter}-0.05*{L_filter}}
SYMBOL cap -1024 1648 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C20
SYMATTR Value {C_block}
SYMBOL cap -1024 2000 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C21
SYMATTR Value {C_block}
SYMBOL res -208 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 0.01
SYMBOL res -208 2000 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R34
SYMATTR Value 0.01
SYMBOL res -432 -96 R0
SYMATTR InstName R4
SYMATTR Value {R_diff/2}
SYMBOL res -432 112 R0
SYMATTR InstName R5
SYMATTR Value {R_diff/2}
TEXT -1336 -216 Left 2 !.param C_P=5e-9 C_H=5e-9 t_rf=2.14e-9 tch=100e-9 C_block=100e-9 R_diff=10 R_tl=1 R_div=4.7e3 L_filter=1pH C_filter=100pF
TEXT -2400 1008 Left 2 ;.tran 0 10e-6 0 1e-10
TEXT -3024 -976 Left 2 ;CLK_LOW:\n- SW1, SW2: closed, SW3: open\n- Ch is charged\nCLK LOW->HIGH:\n- SW1, SW2: opened, SW3: closed\n- SHA in HOLD mode\na few moments later\n- SW3 closed\n- Amplifier output == CH voltage
TEXT 1040 56 Left 2 !.model SW1 SW(Ron=50 Roff=1e9 Vt=1.5 Vh=0)
TEXT 1088 -104 Left 2 ;Ideal buffering OPAMP \n- SHORT between 2 inputs\n- infinite input impedance\nNote: in order to buffer a differential signals we need 2 buffers
TEXT 1120 160 Left 2 ;Input impedance for next stage
TEXT -2384 960 Left 2 !.ac oct 1e3 1e3 15e6
TEXT -3040 -616 Left 2 ;NOTES ON DIFFERENTIAL VS SINGLE-ENDED FILTERS\nDifferential filter\n- differential impedance Zd(f) (to differential component: Vd = V+ - V-)\n- common mode impedance infinity (to common-mode component (V+ + V-) / 2) \n- So the filter acts purely on the differential mode.\n- Ground variations only affect common-mode voltage, not the filtered differential voltage\nSingle-ended filter\n- Filters signal w.r.t. ground -> single-ended signals take this path back to source.\n- Stray currents can change the filter's behavior and the line voltage
RECTANGLE Normal 656 448 -192 -192 2
RECTANGLE Normal -528 1296 -1008 752 2
RECTANGLE Normal 688 1344 -160 704 2
RECTANGLE Normal -528 2144 -1008 1600 2
RECTANGLE Normal 688 2192 -160 1552 2
